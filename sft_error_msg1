python -m homework.sft train --output_dir=homework/sft_model
<frozen runpy>:128: RuntimeWarning: 'homework.sft' found in sys.modules after import of package 'homework', but prior to execution of 'homework.sft'; this may result in unpredictable behaviour
Trainable: base_model.model.model.layers.0.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.0.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.0.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.1.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.1.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.2.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.2.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.3.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.3.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.4.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.4.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.5.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.5.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.6.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.6.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.7.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.7.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.8.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.8.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.9.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.9.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.10.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.10.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.11.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.11.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.12.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.12.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.13.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.13.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.14.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.14.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.15.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.15.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.16.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.16.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.17.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.17.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.18.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.18.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.19.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.19.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.20.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.20.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.21.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.21.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.22.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.22.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.23.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.23.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.24.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.24.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.25.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.25.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.26.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.26.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.27.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.27.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.28.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.28.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.29.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.29.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.30.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.30.mlp.down_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.self_attn.q_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.self_attn.q_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.self_attn.k_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.self_attn.k_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.self_attn.v_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.self_attn.v_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.self_attn.o_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.self_attn.o_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.mlp.gate_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.mlp.gate_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.mlp.up_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.mlp.up_proj.lora_B.default.weight
Trainable: base_model.model.model.layers.31.mlp.down_proj.lora_A.default.weight
Trainable: base_model.model.model.layers.31.mlp.down_proj.lora_B.default.weight
C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\homework\sft.py:155: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|                                                                                                              | 0/160 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\torch\utils\checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\homework\sft.py", line 186, in <module>
    Fire({"train": train_model, "test": test_model, "load": load})
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\fire\core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\fire\core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\fire\core.py", line 684, in _CallAndUpdateTrace       
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\homework\sft.py", line 163, in train_model
    trainer.train()
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\transformers\trainer.py", line 2245, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\transformers\trainer.py", line 2560, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\transformers\trainer.py", line 3782, in training_step 
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\accelerate\accelerator.py", line 2454, in backward    
    loss.backward(**kwargs)
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\torch\_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\torch\autograd\__init__.py", line 347, in backward    
    _engine_run_backward(
  File "C:\Users\divya\OneDrive\Desktop\MSAI\ADL\homework3_v3\.venv\Lib\site-packages\torch\autograd\graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
  0%|                                                                                                              | 0/160 [00:17<?, ?it/s]
